<?php

/**
 * Tests basic query functionality.
 *
 * This ensures that the query plugin itself can be used and is able to run
 * queries. It does not test whether SPARQL Views resource fields are available
 * and can be used in queries.
 */
class SparqlViewsBasicQueryTest extends SparqlViewsQueryTest {
  
  public static function getInfo() {
    return array(
      'name' => 'Tests basic SPARQL Views querying',
      'description' => 'Tests some basic functions of SPARQL Views',
      'group' => 'SPARQL Views',
    );
  }

  protected function setUp() {
    parent::setUp('sparql_views', 'sparql_registry', 'views', 'views_ui', 'sparql_views_test');

    $web_user = $this->drupalCreateUser(array('administer sparql_views types',));
    $this->drupalLogin($web_user);
  }

  public function testFieldQuery() {
    $view = $this->getBasicView();

    // Execute the view.
    $view->execute();

    // Test that the query pulled something from the endpoint.
    $this->assertEqual(10, count($view->result), t('The number of returned rows match.'));

    // Test that the query pulled foaf:name from the endpoint.
    $this->assertTrue($view->result[0]->{$this->field_1}, t('The query returned values for foaf:name.'));
  }

}